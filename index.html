<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üõí ŸÖÿ™ÿ¨ÿ± ÿ£ŸÅÿÆŸÖ ÿßŸÑŸÖŸÑÿßÿ®ÿ≥ ŸÑŸÑÿ£ÿ∑ŸÅÿßŸÑ - Safe-shopping</title>
  <style>
    /* ---------- ÿπÿßŸÖ ---------- */
    body {
      font-family: "Cairo", sans-serif;
      direction: rtl;
      margin: 0; 
      padding: 0;
      background: linear-gradient(135deg, #eef2f7, #dbeafe);
      color: #2c3e50;
    }
    
    header {
      background: linear-gradient(135deg, #2563eb, #1e40af);
      color: white; 
      text-align: center; 
      padding: 20px 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    
    .logo { 
      font-size: 23px; 
      font-weight: bold; 
      letter-spacing: 1px; 
    }
    
    .tagline { 
      font-size: 18px; 
      margin-top: 4px; 
      opacity: 0.9; 
    }

    /* ---------- ÿ≥ŸÑÿßŸäÿØÿ± ---------- */
    .slideshow {
      width: 96%; 
      max-width: 700px; 
      margin: 24px auto 6px;
      position: relative; 
      overflow: hidden; 
      border-radius: 14px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.18); 
      background: #fff; 
      text-align: center;
    }
    
    .slideshow .slide { 
      display: none; 
      border-radius: 14px; 
      padding: 10px; 
    }
    
    .slideshow .slide.active { 
      display: block; 
      animation: fade 0.9s ease-in-out; 
    }
    
    @keyframes fade { 
      from { opacity: 0.4; transform: scale(1.01); } 
      to { opacity: 1; transform: scale(1); } 
    }
    
    .slideshow img { 
      max-width: 90%; 
      max-height: 350px; 
      border-radius: 12px; 
      object-fit: cover; 
    }
    
    .modal-price { 
      margin-top: 8px; 
      font-weight: bold; 
      color: #118a3b; 
      font-size: 18px; 
    }

    /* ---------- ÿßŸÑŸÅŸàÿ±ŸÖ ---------- */
    form {
      max-width: 700px; 
      margin: 18px auto 40px; 
      padding: 22px;
      background: #fff; 
      border-radius: 14px; 
      box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    }
    
    h2 { 
      text-align: center; 
      color: #2563eb; 
      margin: 10px 0; 
    }
    
    label { 
      display: block; 
      margin-top: 12px; 
      font-weight: bold; 
      color: #344; 
    }
    
    input, select, textarea {
      width: 96%; 
      padding: 10px; 
      margin-top: 6px; 
      font-size: 18px;
      border-radius: 10px; 
      border: 1px solid #ccc; 
      transition: 0.2s; 
      box-sizing: border-box;
    }
    
    input:focus, select:focus, textarea:focus {
      border-color: #2563eb; 
      box-shadow: 0 0 6px rgba(37,99,235,0.18); 
      outline: none;
    }

    /* ÿßŸÑŸÄ price box ŸÖÿπ ÿßŸÑŸÜŸÇÿ∑ÿ© ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ© */
    #priceDetails {
      width: 260px; 
      height: 140px; 
      border: 3px solid #2563eb; 
      border-radius: 12px;
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      justify-content: center;
      margin: 20px auto; 
      background: #f0f9ff; 
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      font-weight: bold; 
      color: #118a3b; 
      font-size: 15px; 
      position: relative; 
      overflow: hidden;
    }
    
    #priceDetails::before {
      content: ''; 
      width: 14px; 
      height: 15px; 
      background: gold; 
      border-radius: 50%;
      position: absolute; 
      top: 0; 
      left: 0; 
      animation: squareMove 4s linear infinite;
    }
    
    @keyframes squareMove{
      0% { top: 0; left: 0 }
      25% { top: 0; left: calc(100% - 12px) }
      50% { top: calc(100% - 12px); left: calc(100% - 12px) }
      75% { top: calc(100% - 12px); left: 0 }
      100% { top: 0; left: 0 }
    }

    /* moving hint */
    .moving-box { 
      position: relative; 
      width: 96%; 
      max-width: 360px; 
      height: 50px; 
      margin: 30px auto;
      border-radius: 14px; 
      overflow: hidden; 
      background: linear-gradient(135deg, #2563eb, #3b82f6);
      box-shadow: 0 6px 16px rgba(0,0,0,0.25); 
      display: flex; 
      justify-content: center; 
      align-items: center;
      color: #fff; 
      font-weight: bold; 
      font-size: 16px;
    }
    
    .moving-text { 
      position: absolute; 
      animation: slideDown 3s ease-in-out infinite; 
      white-space: nowrap; 
    }
    
    .arrow { 
      position: absolute; 
      right: 12px; 
      font-size: 24px; 
      color: #FFD700; 
      animation: bounceArrow 1s infinite alternate; 
    }
    
    @keyframes slideDown { 
      0% { top: -100%; opacity: 0 } 
      30% { top: 20%; opacity: 1 } 
      70% { top: 20%; opacity: 1 } 
      100% { top: 120%; opacity: 0 } 
    }
    
    @keyframes bounceArrow { 
      from { transform: translateY(0) } 
      to { transform: translateY(8px) } 
    }

    /* ÿ≤ÿ± ÿßŸÑÿπÿ±ÿ®ÿ© */
    .cart-btn {
      margin: 18px auto;
      width: 60%;
      padding: 10px;
      background: linear-gradient(135deg, #f59e0b, #d97706);
      color: #fff;
      border: none;
      border-radius: 14px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      box-shadow: 0 6px 14px rgba(0,0,0,0.25);
      animation: pulse 0.8s infinite;
    }
    
    .cart-btn:hover { 
      transform: translateY(-3px) scale(1.02); 
      box-shadow: 0 8px 18px rgba(0,0,0,0.3); 
    }
    
    @keyframes pulse { 
      0% { transform: scale(1) } 
      50% { transform: scale(1.03) } 
      100% { transform: scale(1) } 
    }

    /* ŸÉŸÑ ŸÇÿ∑ÿπÿ© */
    .piece { 
      border: 2px dashed #2563eb; 
      padding: 12px; 
      border-radius: 10px; 
      margin-bottom: 12px; 
      background: #f0f9ff; 
    }
    
    .piece img { 
      max-width: 240px; 
      display: block; 
      margin: 8px auto; 
      border-radius: 10px; 
      box-shadow: 0 4px 10px rgba(0,0,0,0.2); 
    }

    /* ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ£ŸÉŸäÿØ ŸàÿßŸÑÿ•ŸÑÿ∫ÿßÿ° */
    #orderControls {
      display: none;
      margin-top: 14px;
      display: flex; 
      gap: 12px; 
      justify-content: center; 
      align-items: center;
    }
    
    #orderControls button {
      padding: 10px 16px; 
      border-radius: 10px; 
      border: none; 
      font-weight: bold; 
      cursor: pointer; 
      color: #fff;
      box-shadow: 0 6px 12px rgba(0,0,0,0.12); 
      transition: transform .12s, box-shadow .12s;
    }
    
    #cancelOrder { 
      background: linear-gradient(135deg, #ef4444, #b91c1c); 
    }
    
    #confirmOrder { 
      background: linear-gradient(135deg, #22c55e, #16a34a); 
    }
    
    #orderControls button:hover { 
      transform: translateY(-3px); 
      box-shadow: 0 10px 18px rgba(0,0,0,0.18); 
    }

    /* ÿ≤ÿ± ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÜŸáÿßÿ¶Ÿä */
    #finalSubmit {
      margin-top: 14px; 
      display: none; 
      text-align: center;
    }
    
    #submitBtn {
      padding: 12px 18px; 
      border-radius: 12px; 
      border: none; 
      font-size: 18px; 
      cursor: pointer; 
      color: #fff;
      background: #2563eb; 
      box-shadow: 0 6px 14px rgba(0,0,0,0.18);
    }
    
    #submitBtn:disabled { 
      opacity: 0.6; 
      cursor: not-allowed; 
      filter: grayscale(.1); 
    }

    /* ŸÖŸàÿØÿßŸÑ ÿßŸÑŸÜÿ¨ÿßÿ≠ */
    #successModal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.56);
      z-index: 9999;
      align-items: center;
      justify-content: center;
    }
    
    #successModal.show {
      display: flex;
      animation: fadeInModal 0.4s ease-in-out;
    }
    
    @keyframes fadeInModal {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    #successModal .modal-content {
      background: linear-gradient(145deg, #f0f9ff, #dbeafe);
      padding: 24px 30px;
      border-radius: 16px;
      width: min(420px, 90%);
      text-align: center;
      box-shadow: 0 12px 28px rgba(0,0,0,0.25);
      animation: slideDown 0.4s ease forwards;
      border: 2px solid #2563eb;
      position: relative;
    }
    
    @keyframes slideDown {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .modal-header h3 {
      font-size: 22px;
      color: #065f46;
      margin-top: 10px;
    }
    
    .checkmark {
      font-size: 36px;
      display: inline-block;
      background: #22c55e;
      color: white;
      padding: 12px;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      animation: bounceCheck 0.8s ease;
    }
    
    @keyframes bounceCheck {
      0% { transform: scale(0.8); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    
    .modal-body p {
      font-size: 16px;
      margin: 12px 0;
      color: #1e3a8a;
    }
    
    .modal-body strong {
      color: #2563eb;
    }
    
    .modal-footer button {
      margin-top: 14px;
      padding: 12px 20px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(135deg, #2563eb, #3b82f6);
      color: #fff;
      font-size: 16px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
      transition: transform 0.15s, box-shadow 0.15s;
    }
    
    .modal-footer button:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 8px 18px rgba(0,0,0,0.3);
    }

    /* ŸÖÿÆŸÅŸä ÿπÿßŸÖ */
    .hidden { 
      display: none !important; 
    }
    
    #loading {
      text-align: center;
      padding: 20px;
    }
    
    #loading img {
      max-width: 50px;
    }

    @media (max-width: 520px) {
      .slideshow { max-width: 94%; }
      form { padding: 16px; margin: 12px auto 28px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">üõçÔ∏è Safe-Shopping</div>
    <div class="tagline">ÿ£ÿ≤Ÿäÿßÿ° ÿ£ÿ∑ŸÅÿßŸÑ ÿ®ÿ£ÿ≠ÿØÿ´ ÿßŸÑŸÖŸàÿØŸäŸÑÿßÿ™</div>
  </header>

  <!-- ÿßŸÑÿ≥ŸÑÿßŸäÿØÿ± -->
  <div class="slideshow">
    <div class="slide active">
      <img src="images/modal1.jpg" alt="ŸÖŸàÿØÿßŸÑ 1">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal2.jpg" alt="ŸÖŸàÿØÿßŸÑ 2">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal3.jpg" alt="ŸÖŸàÿØÿßŸÑ 3">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal4.jpg" alt="ŸÖŸàÿØÿßŸÑ 4">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal5.jpg" alt="ŸÖŸàÿØÿßŸÑ 5">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal6.jpg" alt="ŸÖŸàÿØÿßŸÑ 6">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal7.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 7">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal8.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 8">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal9.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 9">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal10.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 10">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal11.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 11">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal12.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 12">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal13.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 13">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal14.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 14">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal15.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 15">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
    <div class="slide">
      <img src="images/modal16.jpg.webp" alt="ŸÖŸàÿØÿßŸÑ 16">
      <div class="modal-price">üí∞ ÿßŸÑÿ≥ÿπÿ±: 3300 ÿØÿ¨</div>
    </div>
  </div>

  <!-- ÿßŸÑŸÅŸàÿ±ŸÖ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä -->
  <form id="orderForm">
    <div class="moving-box">
      <span class="moving-text">ÿ£ÿØÿÆŸÑ ÿßŸÑŸàŸÑÿßŸäÿ© ŸàŸÜŸàÿπ ÿßŸÑÿ™ŸàÿµŸäŸÑ ŸÑŸÖÿπÿ±ŸÅÿ© ÿßŸÑÿ≥ÿπÿ±</span>
      <span class="arrow">‚¨á</span>
    </div>

    <select id="wilaya" name="wilaya" required>
      <option value="">-- ÿßÿÆÿ™ÿ± ÿßŸÑŸàŸÑÿßŸäÿ© --</option>
    </select>
    
    <select id="deliveryType" name="deliveryType">
      <option value="home">ÿßŸÑÿ™ŸàÿµŸäŸÑ ÿ•ŸÑŸâ ÿ®ÿßÿ® ÿßŸÑŸÖŸÜÿ≤ŸÑ</option>
      <option value="desk">ÿßŸÑÿ™ŸàÿµŸäŸÑ ÿßŸÑŸâ ÿßŸÑŸÖŸÉÿ™ÿ®</option>
    </select>

    <div id="priceDetails">üí∞ ÿßŸÑÿ≥ÿπÿ± : 0 ÿØÿ¨<br>üí∏ ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÉŸÑŸä: 0 ÿØÿ¨</div>

    <h2>üõí ÿ£ÿ∂ŸÅ ŸÖŸÜÿ™ÿ¨ÿßÿ™ŸÉ</h2>

    <div id="piecesContainer"></div>

    <button type="button" id="addToCartBtn" class="cart-btn">ÿ£ÿ∂ŸÅ ÿ•ŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©</button>

    <!-- ÿßŸÑŸÇÿ≥ŸÖ ÿßŸÑÿ¥ÿÆÿµŸä (ŸÖÿÆŸÅŸä ÿ≠ÿ™Ÿâ ÿ™ÿ∂ÿ∫ÿ∑ ÿ£ÿ∂ŸÅ ÿ•ŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©) -->
    <div id="personalSection" class="hidden">
      <label>üë§ ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ:</label>
      <input type="text" name="name" id="name" required autocomplete="name">

      <label for="phone">üìû ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ:</label>
      <input type="tel" id="phone" name="phone" dir="rtl" placeholder="ÿ£ÿØÿÆŸÑ ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ"
        pattern="^[0-9]{10}$" maxlength="10" required
        oninvalid="this.setCustomValidity('ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿ±ŸÇŸÖ Ÿáÿßÿ™ŸÅ ÿµÿ≠Ÿäÿ≠ ŸÖŸÉŸàŸÜ ŸÖŸÜ 10 ÿ£ÿ±ŸÇÿßŸÖ')"
        oninput="this.setCustomValidity('')"
        autocomplete="tel">

      <label>üìç ÿßŸÑÿØÿßÿ¶ÿ±ÿ©:</label>
      <input type="text" name="daire" id="daire" required autocomplete="address-level3">

      <label>üè† ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑŸÉÿßŸÖŸÑ:</label>
      <input type="text" name="address" id="address" required autocomplete="street-address">
    </div>

    <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿ•ŸÑÿ∫ÿßÿ°/ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®Ÿäÿ© -->
    <div id="orderControls" class="hidden">
       <button type="button" id="cancelOrder" style="display:none;">‚ùå ÿ•ŸÑÿ∫ÿßÿ°</button>
     <button type="button" id="confirmOrder" style="display:none;">‚úÖ ÿ™ÿ£ŸÉŸäÿØ</button>
   
 

    <!-- ÿ≤ÿ± ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÜŸáÿßÿ¶Ÿä -->
    
      <button type="submit" id="submitBtn" >‚úÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ®</button>
    </div>

    <div id="loading" class="hidden">
      <img src="https://i.gifer.com/ZZ5H.gif" alt="ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ..." width="56">
      <p>‚è≥ ÿ¨ÿßÿ±Ÿä ŸÖÿπÿßŸÑÿ¨ÿ© ÿ∑ŸÑÿ®ŸÉ...</p>
    </div>
  </form>

  <!-- ŸÖŸàÿØÿßŸÑ ÿßŸÑŸÜÿ¨ÿßÿ≠ -->
  <div id="successModal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="checkmark">‚úÖ</span>
        <h3>ÿ™ŸÖ ÿßÿ≥ÿ™ŸÇÿ®ÿßŸÑ ÿ∑ŸÑÿ®ŸÉ ÿ®ŸÜÿ¨ÿßÿ≠!</h3>
      </div>
      <div class="modal-body">
        <p>ÿ¥ŸÉÿ±Ÿãÿß ŸÑŸÉ ÿπŸÑŸâ ÿ∑ŸÑÿ®ŸÉ ŸÅŸä <strong>Safe-Shopping</strong>.</p>
        <p>üìû ÿ≥Ÿäÿ™ŸàÿßÿµŸÑ ŸÖÿπŸÉ ŸÅÿ±ŸäŸÇ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸÇÿ±Ÿäÿ®Ÿãÿß ŸÑÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ® Ÿàÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ™ŸàÿµŸäŸÑ.</p>
        <p id="totalPrice"></p>
      </div>
      <div class="modal-footer">
        <button onclick="closeModal()">ÿ•ÿ∫ŸÑÿßŸÇ</button>
      </div>
    </div>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxfTSyBwq5h9zk_Fioeta4jV7EVyf-3FeM85qPWe0FtqzfOVlyEaWuZ7NwjeyNfMON-/exec";
    
    // ÿ≥ŸÑÿßŸäÿØÿ± ÿ®ÿ≥Ÿäÿ∑
    (function initSlider(){
      const slides = document.querySelectorAll(".slideshow .slide");
      let idx = 0;
      if(!slides || slides.length === 0) return;
      
      function show(i){ 
        slides.forEach((s, j) => s.classList.toggle("active", j === i)); 
      }
      
      function next(){ 
        idx = (idx + 1) % slides.length; 
        show(idx); 
      }
      
      setInterval(next, 3000);
    })();

    // ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ŸàÿµŸäŸÑ
    const deliveryPrices = {
      "ÿ•ÿÆÿ™ÿ± ÿßŸÑŸàŸÑÿßŸäÿ©": { "home": 0, "desk": 0 },
      "ÿ£ÿØÿ±ÿßÿ±": { "home": 1100, "desk": 600 },
      "ÿßŸÑÿ¥ŸÑŸÅ": { "home": 700, "desk": 400 },
      "ÿßŸÑÿ£ÿ∫Ÿàÿßÿ∑": { "home": 900, "desk": 500 },
      "ÿ£ŸÖ ÿßŸÑÿ®ŸàÿßŸÇŸä": { "home": 650, "desk": 400 },
      "ÿ®ÿßÿ™ŸÜÿ©": { "home": 700, "desk": 400 },
      "ÿ®ÿ¨ÿßŸäÿ©": { "home": 700, "desk": 400 },
      "ÿ®ÿ≥ŸÉÿ±ÿ©": { "home": 900, "desk": 500 },
      "ÿ®ÿ¥ÿßÿ±": { "home": 1100, "desk": 600 },
      "ÿßŸÑÿ®ŸÑŸäÿØÿ©": { "home": 500, "desk": 250 },
      "ÿßŸÑÿ®ŸàŸäÿ±ÿ©": { "home": 700, "desk": 400 },
      "ÿ™ŸÖŸÜÿ±ÿßÿ≥ÿ™": { "home": 1300, "desk": 800 },
      "ÿ™ÿ®ÿ≥ÿ©": { "home": 700, "desk": 400 },
      "ÿ™ŸÑŸÖÿ≥ÿßŸÜ": { "home": 800, "desk": 400 },
      "ÿ™Ÿäÿßÿ±ÿ™": { "home": 800, "desk": 400 },
      "ÿ™Ÿäÿ≤Ÿä Ÿàÿ≤Ÿà": { "home": 700, "desk": 400 },
      "ÿßŸÑÿ¨ÿ≤ÿßÿ¶ÿ±": { "home": 500, "desk": 250 },
      "ÿßŸÑÿ¨ŸÑŸÅÿ©": { "home": 900, "desk": 500 },
      "ÿ¨Ÿäÿ¨ŸÑ": { "home": 700, "desk": 400 },
      "ÿ≥ÿ∑ŸäŸÅ": { "home": 700, "desk": 400 },
      "ÿ≥ÿπŸäÿØÿ©": { "home": 800, "desk": 400 },
      "ÿ≥ŸÉŸäŸÉÿØÿ©": { "home": 600, "desk": 400 },
      "ÿ≥ŸäÿØŸä ÿ®ŸÑÿπÿ®ÿßÿ≥": { "home": 700, "desk": 400 },
      "ÿπŸÜÿßÿ®ÿ©": { "home": 700, "desk": 400 },
      "ŸÇÿßŸÑŸÖÿ©": { "home": 600, "desk": 400 },
      "ŸÇÿ≥ŸÜÿ∑ŸäŸÜÿ©": { "home": 600, "desk": 400 },
      "ÿßŸÑŸÖÿØŸäÿ©": { "home": 700, "desk": 400 },
      "ŸÖÿ≥ÿ™ÿ∫ÿßŸÜŸÖ": { "home": 700, "desk": 400 },
      "ÿßŸÑŸÖÿ≥ŸäŸÑÿ©": { "home": 800, "desk": 400 },
      "ŸÖÿπÿ≥ŸÉÿ±": { "home": 700, "desk": 400 },
      "Ÿàÿ±ŸÇŸÑÿ©": { "home": 900, "desk": 500 },
      "ŸàŸáÿ±ÿßŸÜ": { "home": 800, "desk": 400 },
      "ÿßŸÑÿ®Ÿäÿ∂": { "home": 800, "desk": 500 },
      "ÿ•ŸÑŸäÿ≤Ÿä": { "home": 1300, "desk": 600 },
      "ÿ®ÿ±ÿ¨ ÿ®Ÿàÿπÿ±Ÿäÿ±Ÿäÿ¨": { "home": 700, "desk": 400 },
      "ÿ®ŸàŸÖÿ±ÿØÿßÿ≥": { "home": 700, "desk": 400 },
      "ÿßŸÑÿ∑ÿßÿ±ŸÅ": { "home": 700, "desk": 400 },
      "ÿ™ŸÜÿØŸàŸÅ": { "home": 1300, "desk": 600 },
      "ÿ™Ÿäÿ≥ŸÖÿ≥ŸäŸÑÿ™": { "home": 800, "desk": 400 },
      "ÿßŸÑŸàÿßÿØŸä": { "home": 900, "desk": 500 },
      "ÿÆŸÜÿ¥ŸÑÿ©": { "home": 700, "desk": 500 },
      "ÿ≥ŸàŸÇ ÿ£Ÿáÿ±ÿßÿ≥": { "home": 700, "desk": 400 },
      "ÿ™Ÿäÿ®ÿßÿ≤ÿ©": { "home": 700, "desk": 400 },
      "ŸÖŸäŸÑÿ©": { "home": 500, "desk": 350 },
      "ÿπŸäŸÜ ÿßŸÑÿØŸÅŸÑŸâ": { "home": 700, "desk": 400 },
      "ÿßŸÑŸÜÿπÿßŸÖÿ©": { "home": 800, "desk": 500 },
      "ÿπŸäŸÜ ÿ™ŸÖŸàÿ¥ŸÜÿ™": { "home": 800, "desk": 400 },
      "ÿ∫ÿ±ÿØÿßŸäÿ©": { "home": 900, "desk": 500 },
      "ÿ∫ŸÑŸäÿ≤ÿßŸÜ": { "home": 700, "desk": 400 },
      "ÿ™ŸäŸÖŸäŸÖŸàŸÜ": { "home": 1100, "desk": 600 },
      "ÿ£ŸàŸÑÿßÿØ ÿ¨ŸÑÿßŸÑ": { "home": 900, "desk": 500 },
      "ÿ•ŸÜ ÿµÿßŸÑÿ≠": { "home": 1300, "desk": 600 },
      "ÿ¨ÿßŸÜÿ™": { "home": 1100, "desk": 500 }
    };

    // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸàŸÑÿßŸäÿßÿ™ ÿ•ŸÑŸâ ÿßŸÑŸÇÿßÿ¶ŸÖÿ©
    const wilayaSelect = document.getElementById("wilaya");
    Object.keys(deliveryPrices).forEach(w => {
      const opt = document.createElement("option"); 
      opt.value = w; 
      opt.textContent = w; 
      wilayaSelect.appendChild(opt);
    });

    // ÿπŸÜÿßÿµÿ± DOM ŸÖŸáŸÖÿ©
    const addToCartBtn = document.getElementById("addToCartBtn");
    const piecesContainer = document.getElementById("piecesContainer");
    const personalSection = document.getElementById("personalSection");
    const orderControls = document.getElementById("orderControls");
    const cancelOrderBtn = document.getElementById("cancelOrder");
    const confirmOrderBtn = document.getElementById("confirmOrder");
    const finalSubmitDiv = document.getElementById("finalSubmit");
    const submitBtn = document.getElementById("submitBtn");
    const priceDetailsEl = document.getElementById("priceDetails");
    const loadingEl = document.getElementById("loading");

    let pieceCount = 0;
    let currentTotal = 0;

    // ÿØŸàÿßŸÑ ÿßŸÑŸÖŸàÿØÿßŸÑ/ÿßŸÑŸÖŸÇÿßÿ≥
    function getSize(height){
      if(height >= 6 && height <= 7) return "S1";
      if(height >= 8 && height <= 9) return "S2";
      if(height >= 10 && height <= 11) return "S3";
      if(height >= 12 && height <= 13) return "S4";
      return "ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ±";
    }

    // ÿ•ÿ∂ÿßŸÅÿ© ŸÇÿ∑ÿπÿ©
    function addPiece(){
      pieceCount++;
      const div = document.createElement("div");
      div.className = "piece";
      const heightOptions = Array.from({length: 10}, (_, i) => `<option value="${5+i}">${5+i} ÿ≥ŸÜŸàÿßÿ™</option>`).join('');
      
      div.innerHTML = `
        <label>üß© ÿßÿÆÿ™ÿ± ÿßŸÑŸÖŸàÿØÿßŸÑ:</label>
        <select name="modal${pieceCount}" onchange="showModalImage(this, ${pieceCount}); updatePrice();" required>
          <option value="">-- ÿßÿÆÿ™ÿ± --</option>
          <option value="1">ŸÖŸàÿØÿßŸÑ 1</option>
          <option value="2">ŸÖŸàÿØÿßŸÑ 2</option>
          <option value="3">ŸÖŸàÿØÿßŸÑ 3</option>
          <option value="4">ŸÖŸàÿØÿßŸÑ 4</option>
          <option value="5">ŸÖŸàÿØÿßŸÑ 5</option>
          <option value="6">ŸÖŸàÿØÿßŸÑ 6</option>
          <option value="7">ŸÖŸàÿØÿßŸÑ 7</option>
          <option value="8">ŸÖŸàÿØÿßŸÑ 8</option>
          <option value="9">ŸÖŸàÿØÿßŸÑ 9</option>
          <option value="10">ŸÖŸàÿØÿßŸÑ 10</option>
          <option value="11">ŸÖŸàÿØÿßŸÑ 11</option>
          <option value="12">ŸÖŸàÿØÿßŸÑ 12</option>
          <option value="13">ŸÖŸàÿØÿßŸÑ 13</option>
          <option value="14">ŸÖŸàÿØÿßŸÑ 14</option>
          <option value="15">ŸÖŸàÿØÿßŸÑ 15</option>
          <option value="16">ŸÖŸàÿØÿßŸÑ 16</option>
          
          
        </select>
        <div id="modalImage${pieceCount}" style="margin-top:10px; text-align:center;"></div>

        <label>üî¢ ÿßŸÑŸÉŸÖŸäÿ©:</label>
        <select name="quantity${pieceCount}" onchange="updatePrice()" required>
          ${Array.from({length: 10}, (_, i) => `<option value="${i+1}">${i+1}</option>`).join('')}
        </select>

        <label>üé® ÿßŸÑŸÑŸàŸÜ:</label>
        <select name="color${pieceCount}" required>
          <option value="ÿ£ÿ®Ÿäÿ∂">ÿ£ÿ®Ÿäÿ∂</option>
          <option value="ÿ£ÿ≥ŸàÿØ">ÿ£ÿ≥ŸàÿØ</option>
          <option value="ÿ±ŸÖÿßÿØŸä">ÿ±ŸÖÿßÿØŸä</option>
          <option value="ÿ£ÿ≤ÿ±ŸÇ">ÿ£ÿ≤ÿ±ŸÇ</option>
          <option value="ÿ£ÿ≠ŸÖÿ±">ÿ£ÿ≠ŸÖÿ±</option>
          <option value="ÿ£ÿÆÿ∂ÿ±">ÿ£ÿÆÿ∂ÿ±</option>
        </select>

        <label>üìè ÿπŸÖÿ± ÿßŸÑÿ∑ŸÅŸÑ:</label>
        <select name="age${pieceCount}" onchange="updateSize(this, ${pieceCount})" required>${heightOptions}</select>

        <label>üìê ÿßŸÑŸÖŸÇÿßÿ≥:</label>
        <input type="text" name="size${pieceCount}" id="size${pieceCount}" readonly>

        <button type="button" onclick="removePiece(this)" style="margin-top:10px; background:#ef4444; color:#fff; border:none; border-radius:8px; padding:8px 10px;">üóëÔ∏è ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ∑ŸÑÿ®</button>
      `;
      
      piecesContainer.appendChild(div);
      personalSection.classList.remove("hidden");
      orderControls.classList.remove("hidden");
      finalSubmitDiv.classList.remove("hidden");
      submitBtn.disabled = true;
      updatePrice();
    }

    // ÿ•ÿ≤ÿßŸÑÿ© ŸÇÿ∑ÿπÿ©
    function removePiece(button){
      button.closest(".piece").remove();
      updatePrice();
      
      if(document.querySelectorAll(".piece").length === 0){
        personalSection.classList.add("hidden");
        orderControls.classList.add("hidden");
        finalSubmitDiv.classList.add("hidden");
      }
    }

    // ÿπÿ±ÿ∂ ÿµŸàÿ±ÿ©
    function showModalImage(select, id){
      const imgDiv = document.getElementById(`modalImage${id}`);
      const val = select.value;
      if(!val){ 
        imgDiv.innerHTML = ""; 
        return; 
      }
      
      const modalImages = {
        "1": "images/modal1.jpg",
        "2": "images/modal2.jpg",
        "3": "images/modal3.jpg",
        "4": "images/modal4.jpg",
        "5": "images/modal5.jpg",
         "6": "images/modal6.jpg.webp",
         "7": "images/modal7.jpg.webp",
         "8": "images/modal8.jpg.webp",
         "9": "images/modal9.jpg.webp",
         "10": "images/modal10.jpg.webp",
          "11": "images/modal11.jpg.webp",
          "12": "images/modal12.jpg.webp",
          "13": "images/modal13.jpg.webp",
          "14": "images/modal14.jpg.webp",
          "15": "images/modal15.jpg.webp",
          "16": "images/modal16.jpg.webp"
      };
      
      imgDiv.innerHTML = `<img src="${modalImages[val]}" alt="ŸÖŸàÿØÿßŸÑ ${val}" style="max-width:220px; border-radius:8px;">`;
    }

    function updateSize(select, id){
      const height = parseInt(select.value);
      if(height) document.getElementById(`size${id}`).value = getSize(height);
    }

    // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ≥ÿπÿ±
    function updatePrice() {
      let totalPieces = 0;
      let subtotal = 0;

      for (let i = 1; i <= pieceCount; i++) {
        const quantityEl = document.querySelector(`[name="quantity${i}"]`);
        if (quantityEl) {
          const qty = parseInt(quantityEl.value) || 0;
          totalPieces += qty;
        }
      }

      let unitPrice = (totalPieces >= 2) ? 3000 : 3300;
      subtotal = totalPieces * unitPrice;

      const wilaya = document.getElementById("wilaya").value;
      const deliveryType = document.getElementById("deliveryType").value;
      const deliveryCost = deliveryPrices[wilaya] ? deliveryPrices[wilaya][deliveryType] : 0;

      currentTotal = subtotal + deliveryCost;

      priceDetailsEl.innerHTML = `
        üí∞ ÿ≥ÿπÿ± ÿßŸÑŸÇÿ∑ÿπÿ©: ${unitPrice} ÿØÿ¨ <br>
        üî¢ ÿπÿØÿØ ÿßŸÑŸÇÿ∑ÿπ: ${totalPieces} <br>
        üí∏ ÿßŸÑŸÖÿ¨ŸÖŸàÿπ: ${subtotal} ÿØÿ¨ <br>
        üöö ÿßŸÑÿ™ŸàÿµŸäŸÑ: ${deliveryCost} ÿØÿ¨ <br>
        ‚úÖ ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÉŸÑŸä: ${currentTotal} ÿØÿ¨
      `;
      
      return currentTotal;
    }

    // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ≥ÿπÿ± ÿπŸÜÿØ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸàŸÑÿßŸäÿ© ÿ£Ÿà ŸÜŸàÿπ ÿßŸÑÿ™ŸàÿµŸäŸÑ
    wilayaSelect.addEventListener("change", updatePrice);
    document.getElementById("deliveryType").addEventListener("change", updatePrice);

    // ÿ≤ÿ± "ÿ£ÿ∂ŸÅ ÿ•ŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©"
    addToCartBtn.addEventListener("click", () => {
      addPiece();
      setTimeout(() => window.scrollTo({ 
        top: document.getElementById('orderForm').offsetTop + 200, 
        behavior: 'smooth' 
      }), 200);
    });

    // ÿ≤ÿ± ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ∑ŸÑÿ®Ÿäÿ©
    cancelOrderBtn.addEventListener("click", () => {
      piecesContainer.innerHTML = "";
      pieceCount = 0;
      currentTotal = 0;
      priceDetailsEl.innerHTML = `üí∞ ÿßŸÑÿ≥ÿπÿ± : 0 ÿØÿ¨<br>üí∏ ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÉŸÑŸä: 0 ÿØÿ¨`;
      personalSection.classList.add("hidden");
      orderControls.classList.add("hidden");
      finalSubmitDiv.classList.add("hidden");
      submitBtn.disabled = true;
      
      document.getElementById('name').value = "";
      document.getElementById('phone').value = "";
      document.getElementById('daire').value = "";
      document.getElementById('address').value = "";
      
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // ÿ≤ÿ± ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®Ÿäÿ©
    confirmOrderBtn.addEventListener("click", () => {
      submitBtn.disabled = false;
      submitBtn.style.transform = "scale(1.02)";
      submitBtn.style.boxShadow = "0 10px 24px rgba(0,0,0,0.2)";
      confirmOrderBtn.textContent = "‚úÖ ÿ™ŸÖ ÿßŸÑÿ™ÿ£ŸÉŸäÿØ";
      confirmOrderBtn.disabled = true;
      
      setTimeout(() => window.scrollTo({ 
        top: submitBtn.getBoundingClientRect().top + window.scrollY - 80, 
        behavior: 'smooth' 
      }), 200);
    });

    // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ
    document.getElementById("orderForm").addEventListener("submit", function(e){
      e.preventDefault();
      
      if(submitBtn.disabled){
        alert("ÿßŸÑÿ±ÿ¨ÿßÿ° ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ 'ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®Ÿäÿ©' ŸÇÿ®ŸÑ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ.");
        return;
      }
      
      const form = this;
      const formData = new FormData(form);
      
      // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÉŸÑŸä ÿ•ŸÑŸâ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
      formData.append('total', currentTotal);
      
      loadingEl.classList.remove('hidden');

      fetch(SCRIPT_URL, { method: 'POST', body: formData })
        .then(res => {
          if (!res.ok) {
            throw new Error('Network response was not ok');
          }
          return res.text();
        })
        .then(data => {
          loadingEl.classList.add('hidden');
          
          // ÿπÿ±ÿ∂ ÿßŸÑŸÖŸàÿØÿßŸÑ ÿ®ŸÜÿ¨ÿßÿ≠
          document.getElementById('totalPrice').textContent = `üí∏ ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÉŸÑŸä: ${currentTotal} ÿØÿ¨`;
          document.getElementById('successModal').classList.add('show');
          
          // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨
          form.reset();
          piecesContainer.innerHTML = "";
          pieceCount = 0;
          currentTotal = 0;
          personalSection.classList.add("hidden");
          orderControls.classList.add("hidden");
          finalSubmitDiv.classList.add("hidden");
          submitBtn.disabled = true;
          priceDetailsEl.innerHTML = `üí∞ ÿßŸÑÿ≥ÿπÿ± : 0 ÿØÿ¨<br>üí∏ ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÉŸÑŸä: 0 ÿØÿ¨`;
          
          confirmOrderBtn.textContent = "‚úÖ ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®Ÿäÿ©";
          confirmOrderBtn.disabled = false;
        })
        
    });

    function closeModal(){ 
      document.getElementById('successModal').classList.remove('show');
    }

    // ÿ¨ÿπŸÑ ÿßŸÑÿØŸàÿßŸÑ ŸÖÿ™ÿßÿ≠ÿ© ÿπÿßŸÑŸÖŸäÿßŸã
    window.addPiece = addPiece;
    window.removePiece = removePiece;
    window.showModalImage = showModalImage;
    window.updateSize = updateSize;
    window.updatePrice = updatePrice;
    window.closeModal = closeModal;
  </script>
</body>
</html>
