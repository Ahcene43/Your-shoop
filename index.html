<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸ›’ Ù…ØªØ¬Ø± Ø£ÙØ®Ù… Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ù„Ù„Ø£Ø·ÙØ§Ù„ - Safe-shopping</title>
  <style>
    /* ---------- Ø¹Ø§Ù… ---------- */
    body {
      font-family: "Cairo", sans-serif;
      direction: rtl;
      margin: 0; 
      padding: 0;
      background: linear-gradient(135deg, #eef2f7, #dbeafe);
      color: #2c3e50;
    }
    
    header {
      background: linear-gradient(135deg, #2563eb, #1e40af);
      color: white; 
      text-align: center; 
      padding: 20px 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    
    .logo { 
      font-size: 23px; 
      font-weight: bold; 
      letter-spacing: 1px; 
    }
    
    .tagline { 
      font-size: 18px; 
      margin-top: 4px; 
      opacity: 0.9; 
    }

    /* ---------- Ø³Ù„Ø§ÙŠØ¯Ø± ---------- */
    .slideshow {
      width: 96%; 
      max-width: 700px; 
      margin: 24px auto 6px;
      position: relative; 
      overflow: hidden; 
      border-radius: 14px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.18); 
      background: #fff; 
      text-align: center;
    }
    
    .slideshow .slide { 
      display: none; 
      border-radius: 14px; 
      padding: 10px; 
    }
    
    .slideshow .slide.active { 
      display: block; 
      animation: fade 0.9s ease-in-out; 
    }
    
    @keyframes fade { 
      from { opacity: 0.4; transform: scale(1.01); } 
      to { opacity: 1; transform: scale(1); } 
    }
    
    .slideshow img { 
      max-width: 90%; 
      max-height: 350px; 
      border-radius: 12px; 
      object-fit: cover; 
    }
    
    .modal-price { 
      margin-top: 8px; 
      font-weight: bold; 
      color: #118a3b; 
      font-size: 18px; 
    }

    /* ---------- Ø§Ù„ÙÙˆØ±Ù… ---------- */
    form {
      max-width: 700px; 
      margin: 18px auto 40px; 
      padding: 22px;
      background: #fff; 
      border-radius: 14px; 
      box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    }
    
    h2 { 
      text-align: center; 
      color: #2563eb; 
      margin: 10px 0; 
    }
    
    label { 
      display: block; 
      margin-top: 12px; 
      font-weight: bold; 
      color: #344; 
    }
    
    input, select, textarea {
      width: 96%; 
      padding: 10px; 
      margin-top: 6px; 
      font-size: 18px;
      border-radius: 10px; 
      border: 1px solid #ccc; 
      transition: 0.2s; 
      box-sizing: border-box;
    }
    
    input:focus, select:focus, textarea:focus {
      border-color: #2563eb; 
      box-shadow: 0 0 6px rgba(37,99,235,0.18); 
      outline: none;
    }

    /* Ø§Ù„Ù€ price box Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
    #priceDetails {
      width: 260px; 
      height: 140px; 
      border: 3px solid #2563eb; 
      border-radius: 12px;
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      justify-content: center;
      margin: 20px auto; 
      background: #f0f9ff; 
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      font-weight: bold; 
      color: #118a3b; 
      font-size: 15px; 
      position: relative; 
      overflow: hidden;
    }
    
    #priceDetails::before {
      content: ''; 
      width: 14px; 
      height: 15px; 
      background: gold; 
      border-radius: 50%;
      position: absolute; 
      top: 0; 
      left: 0; 
      animation: squareMove 4s linear infinite;
    }
    
    @keyframes squareMove{
      0% { top: 0; left: 0 }
      25% { top: 0; left: calc(100% - 12px) }
      50% { top: calc(100% - 12px); left: calc(100% - 12px) }
      75% { top: calc(100% - 12px); left: 0 }
      100% { top: 0; left: 0 }
    }

    /* moving hint */
    .moving-box { 
      position: relative; 
      width: 96%; 
      max-width: 360px; 
      height: 50px; 
      margin: 30px auto;
      border-radius: 14px; 
      overflow: hidden; 
      background: linear-gradient(135deg, #2563eb, #3b82f6);
      box-shadow: 0 6px 16px rgba(0,0,0,0.25); 
      display: flex; 
      justify-content: center; 
      align-items: center;
      color: #fff; 
      font-weight: bold; 
      font-size: 16px;
    }
    
    .moving-text { 
      position: absolute; 
      animation: slideDown 3s ease-in-out infinite; 
      white-space: nowrap; 
    }
    
    .arrow { 
      position: absolute; 
      right: 12px; 
      font-size: 24px; 
      color: #FFD700; 
      animation: bounceArrow 1s infinite alternate; 
    }
    
    @keyframes slideDown { 
      0% { top: -100%; opacity: 0 } 
      30% { top: 20%; opacity: 1 } 
      70% { top: 20%; opacity: 1 } 
      100% { top: 120%; opacity: 0 } 
    }
    
    @keyframes bounceArrow { 
      from { transform: translateY(0) } 
      to { transform: translateY(8px) } 
    }

    /* Ø²Ø± Ø§Ù„Ø¹Ø±Ø¨Ø© */
    .cart-btn {
      margin: 18px auto;
      width: 60%;
      padding: 10px;
      background: linear-gradient(135deg, #f59e0b, #d97706);
      color: #fff;
      border: none;
      border-radius: 14px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      box-shadow: 0 6px 14px rgba(0,0,0,0.25);
      animation: pulse 0.8s infinite;
    }
    
    .cart-btn:hover { 
      transform: translateY(-3px) scale(1.02); 
      box-shadow: 0 8px 18px rgba(0,0,0,0.3); 
    }
    
    @keyframes pulse { 
      0% { transform: scale(1) } 
      50% { transform: scale(1.03) } 
      100% { transform: scale(1) } 
    }

    /* ÙƒÙ„ Ù‚Ø·Ø¹Ø© */
    .piece { 
      border: 2px dashed #2563eb; 
      padding: 12px; 
      border-radius: 10px; 
      margin-bottom: 12px; 
      background: #f0f9ff; 
    }
    
    .piece img { 
      max-width: 240px; 
      display: block; 
      margin: 8px auto; 
      border-radius: 10px; 
      box-shadow: 0 4px 10px rgba(0,0,0,0.2); 
    }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯ ÙˆØ§Ù„Ø¥Ù„ØºØ§Ø¡ */
    #orderControls {
      display: none;
      margin-top: 14px;
      display: flex; 
      gap: 12px; 
      justify-content: center; 
      align-items: center;
    }
    
    #orderControls button {
      padding: 10px 16px; 
      border-radius: 10px; 
      border: none; 
      font-weight: bold; 
      cursor: pointer; 
      color: #fff;
      box-shadow: 0 6px 12px rgba(0,0,0,0.12); 
      transition: transform .12s, box-shadow .12s;
    }
    
    #cancelOrder { 
      background: linear-gradient(135deg, #ef4444, #b91c1c); 
    }
    
    #confirmOrder { 
      background: linear-gradient(135deg, #22c55e, #16a34a); 
    }
    
    #orderControls button:hover { 
      transform: translateY(-3px); 
      box-shadow: 0 10px 18px rgba(0,0,0,0.18); 
    }

    /* Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ */
    #finalSubmit {
      margin-top: 14px; 
      display: none; 
      text-align: center;
    }
    
    #submitBtn {
      padding: 12px 18px; 
      border-radius: 12px; 
      border: none; 
      font-size: 18px; 
      cursor: pointer; 
      color: #fff;
      background: #2563eb; 
      box-shadow: 0 6px 14px rgba(0,0,0,0.18);
    }
    
    #submitBtn:disabled { 
      opacity: 0.6; 
      cursor: not-allowed; 
      filter: grayscale(.1); 
    }

    /* Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­ */
    #successModal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.56);
      z-index: 9999;
      align-items: center;
      justify-content: center;
    }
    
    #successModal.show {
      display: flex;
      animation: fadeInModal 0.4s ease-in-out;
    }
    
    @keyframes fadeInModal {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    #successModal .modal-content {
      background: linear-gradient(145deg, #f0f9ff, #dbeafe);
      padding: 24px 30px;
      border-radius: 16px;
      width: min(420px, 90%);
      text-align: center;
      box-shadow: 0 12px 28px rgba(0,0,0,0.25);
      animation: slideDown 0.4s ease forwards;
      border: 2px solid #2563eb;
      position: relative;
    }
    
    @keyframes slideDown {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .modal-header h3 {
      font-size: 22px;
      color: #065f46;
      margin-top: 10px;
    }
    
    .checkmark {
      font-size: 36px;
      display: inline-block;
      background: #22c55e;
      color: white;
      padding: 12px;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      animation: bounceCheck 0.8s ease;
    }
    
    @keyframes bounceCheck {
      0% { transform: scale(0.8); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    
    .modal-body p {
      font-size: 16px;
      margin: 12px 0;
      color: #1e3a8a;
    }
    
    .modal-body strong {
      color: #2563eb;
    }
    
    .modal-footer button {
      margin-top: 14px;
      padding: 12px 20px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(135deg, #2563eb, #3b82f6);
      color: #fff;
      font-size: 16px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
      transition: transform 0.15s, box-shadow 0.15s;
    }
    
    .modal-footer button:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 8px 18px rgba(0,0,0,0.3);
    }

    /* Ù…Ø®ÙÙŠ Ø¹Ø§Ù… */
    .hidden { 
      display: none !important; 
    }
    
    #loading {
      text-align: center;
      padding: 20px;
    }
    
    #loading img {
      max-width: 50px;
    }

    @media (max-width: 520px) {
      .slideshow { max-width: 94%; }
      form { padding: 16px; margin: 12px auto 28px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">ğŸ›ï¸ Safe-Shopping</div>
    <div class="tagline">Ø£Ø²ÙŠØ§Ø¡ Ø£Ø·ÙØ§Ù„ Ø¨Ø£Ø­Ø¯Ø« Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª</div>
  </header>

  <!-- Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± -->
  <div class="slideshow">
    <div class="slide active">
      <img src="images/modal1.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 1">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal2.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 2">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal3.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 3">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal4.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 4">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal5.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 5">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal6.jpg" alt="Ù…ÙˆØ¯Ø§Ù„ 6">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal7.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 7">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal8.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 8">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal9.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 9">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal10.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 10">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal11.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 11">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal12.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 12">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal13.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 13">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal14.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 14">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal15.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 15">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
    <div class="slide">
      <img src="images/modal16.jpg.webp" alt="Ù…ÙˆØ¯Ø§Ù„ 16">
      <div class="modal-price">ğŸ’° Ø§Ù„Ø³Ø¹Ø±: 3300 Ø¯Ø¬</div>
    </div>
  </div>

  <!-- Ø§Ù„ÙÙˆØ±Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
  <form id="orderForm">
    <div class="moving-box">
      <span class="moving-text">Ø£Ø¯Ø®Ù„ Ø§Ù„ÙˆÙ„Ø§ÙŠØ© ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªÙˆØµÙŠÙ„ Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø³Ø¹Ø±</span>
      <span class="arrow">â¬‡</span>
    </div>

    <select id="wilaya" name="wilaya" required>
      <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ© --</option>
    </select>
    
    <select id="deliveryType" name="deliveryType">
      <option value="home">Ø§Ù„ØªÙˆØµÙŠÙ„ Ø¥Ù„Ù‰ Ø¨Ø§Ø¨ Ø§Ù„Ù…Ù†Ø²Ù„</option>
      <option value="desk">Ø§Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ù‰ Ø§Ù„Ù…ÙƒØªØ¨</option>
    </select>

    <div id="priceDetails">ğŸ’° Ø§Ù„Ø³Ø¹Ø± : 0 Ø¯Ø¬<br>ğŸ’¸ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ: 0 Ø¯Ø¬</div>

    <h2>ğŸ›’ Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§ØªÙƒ</h2>

    <div id="piecesContainer"></div>

    <button type="button" id="addToCartBtn" class="cart-btn">Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>

    <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠ (Ù…Ø®ÙÙŠ Ø­ØªÙ‰ ØªØ¶ØºØ· Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©) -->
    <div id="personalSection" class="hidden">
      <label>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
      <input type="text" name="name" id="name" required autocomplete="name">

      <label for="phone">ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
      <input type="tel" id="phone" name="phone" dir="rtl" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"
        pattern="^[0-9]{10}$" maxlength="10" required
        oninvalid="this.setCustomValidity('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­ Ù…ÙƒÙˆÙ† Ù…Ù† 10 Ø£Ø±Ù‚Ø§Ù…')"
        oninput="this.setCustomValidity('')"
        autocomplete="tel">

      <label>ğŸ“ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©:</label>
      <input type="text" name="daire" id="daire" required autocomplete="address-level3">

      <label>ğŸ  Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„:</label>
      <input type="text" name="address" id="address" required autocomplete="street-address">
    </div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø¥Ù„ØºØ§Ø¡/ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ÙŠØ© -->
    <div id="orderControls" class="hidden">
       <button type="button" id="cancelOrder" style="display:none;">âŒ Ø¥Ù„ØºØ§Ø¡</button>
     <button type="button" id="confirmOrder" style="display:none;">âœ… ØªØ£ÙƒÙŠØ¯</button>
   
 

    <!-- Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
    
      <button type="submit" id="submitBtn" >âœ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
    </div>

    <div id="loading" class="hidden">
      <img src="https://i.gifer.com/ZZ5H.gif" alt="Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„..." width="56">
      <p>â³ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ...</p>
    </div>
  </form>

  <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­ -->
  <div id="successModal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="checkmark">âœ…</span>
        <h3>ØªÙ… Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!</h3>
      </div>
      <div class="modal-body">
        <p>Ø´ÙƒØ±Ù‹Ø§ Ù„Ùƒ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ ÙÙŠ <strong>Safe-Shopping</strong>.</p>
        <p>ğŸ“ Ø³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙˆØµÙŠÙ„.</p>
        <p id="totalPrice"></p>
      </div>
      <div class="modal-footer">
        <button onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxfTSyBwq5h9zk_Fioeta4jV7EVyf-3FeM85qPWe0FtqzfOVlyEaWuZ7NwjeyNfMON-/exec";
    
    // Ø³Ù„Ø§ÙŠØ¯Ø± Ø¨Ø³ÙŠØ·
    (function initSlider(){
      const slides = document.querySelectorAll(".slideshow .slide");
      let idx = 0;
      if(!slides || slides.length === 0) return;
      
      function show(i){ 
        slides.forEach((s, j) => s.classList.toggle("active", j === i)); 
      }
      
      function next(){ 
        idx = (idx + 1) % slides.length; 
        show(idx); 
      }
      
      setInterval(next, 3000);
    })();

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„
    const deliveryPrices = {
      "Ø¥Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ©": { "home": 0, "desk": 0 },
      "Ø£Ø¯Ø±Ø§Ø±": { "home": 1100, "desk": 600 },
      "Ø§Ù„Ø´Ù„Ù": { "home": 700, "desk": 400 },
      "Ø§Ù„Ø£ØºÙˆØ§Ø·": { "home": 900, "desk": 500 },
      "Ø£Ù… Ø§Ù„Ø¨ÙˆØ§Ù‚ÙŠ": { "home": 650, "desk": 400 },
      "Ø¨Ø§ØªÙ†Ø©": { "home": 700, "desk": 400 },
      "Ø¨Ø¬Ø§ÙŠØ©": { "home": 700, "desk": 400 },
      "Ø¨Ø³ÙƒØ±Ø©": { "home": 900, "desk": 500 },
      "Ø¨Ø´Ø§Ø±": { "home": 1100, "desk": 600 },
      "Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©": { "home": 500, "desk": 250 },
      "Ø§Ù„Ø¨ÙˆÙŠØ±Ø©": { "home": 700, "desk": 400 },
      "ØªÙ…Ù†Ø±Ø§Ø³Øª": { "home": 1300, "desk": 800 },
      "ØªØ¨Ø³Ø©": { "home": 700, "desk": 400 },
      "ØªÙ„Ù…Ø³Ø§Ù†": { "home": 800, "desk": 400 },
      "ØªÙŠØ§Ø±Øª": { "home": 800, "desk": 400 },
      "ØªÙŠØ²ÙŠ ÙˆØ²Ùˆ": { "home": 700, "desk": 400 },
      "Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±": { "home": 500, "desk": 250 },
      "Ø§Ù„Ø¬Ù„ÙØ©": { "home": 900, "desk": 500 },
      "Ø¬ÙŠØ¬Ù„": { "home": 700, "desk": 400 },
      "Ø³Ø·ÙŠÙ": { "home": 700, "desk": 400 },
      "Ø³Ø¹ÙŠØ¯Ø©": { "home": 800, "desk": 400 },
      "Ø³ÙƒÙŠÙƒØ¯Ø©": { "home": 600, "desk": 400 },
      "Ø³ÙŠØ¯ÙŠ Ø¨Ù„Ø¹Ø¨Ø§Ø³": { "home": 700, "desk": 400 },
      "Ø¹Ù†Ø§Ø¨Ø©": { "home": 700, "desk": 400 },
      "Ù‚Ø§Ù„Ù…Ø©": { "home": 600, "desk": 400 },
      "Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©": { "home": 600, "desk": 400 },
      "Ø§Ù„Ù…Ø¯ÙŠØ©": { "home": 700, "desk": 400 },
      "Ù…Ø³ØªØºØ§Ù†Ù…": { "home": 700, "desk": 400 },
      "Ø§Ù„Ù…Ø³ÙŠÙ„Ø©": { "home": 800, "desk": 400 },
      "Ù…Ø¹Ø³ÙƒØ±": { "home": 700, "desk": 400 },
      "ÙˆØ±Ù‚Ù„Ø©": { "home": 900, "desk": 500 },
      "ÙˆÙ‡Ø±Ø§Ù†": { "home": 800, "desk": 400 },
      "Ø§Ù„Ø¨ÙŠØ¶": { "home": 800, "desk": 500 },
      "Ø¥Ù„ÙŠØ²ÙŠ": { "home": 1300, "desk": 600 },
      "Ø¨Ø±Ø¬ Ø¨ÙˆØ¹Ø±ÙŠØ±ÙŠØ¬": { "home": 700, "desk": 400 },
      "Ø¨ÙˆÙ…Ø±Ø¯Ø§Ø³": { "home": 700, "desk": 400 },
      "Ø§Ù„Ø·Ø§Ø±Ù": { "home": 700, "desk": 400 },
      "ØªÙ†Ø¯ÙˆÙ": { "home": 1300, "desk": 600 },
      "ØªÙŠØ³Ù…Ø³ÙŠÙ„Øª": { "home": 800, "desk": 400 },
      "Ø§Ù„ÙˆØ§Ø¯ÙŠ": { "home": 900, "desk": 500 },
      "Ø®Ù†Ø´Ù„Ø©": { "home": 700, "desk": 500 },
      "Ø³ÙˆÙ‚ Ø£Ù‡Ø±Ø§Ø³": { "home": 700, "desk": 400 },
      "ØªÙŠØ¨Ø§Ø²Ø©": { "home": 700, "desk": 400 },
      "Ù…ÙŠÙ„Ø©": { "home": 500, "desk": 350 },
      "Ø¹ÙŠÙ† Ø§Ù„Ø¯ÙÙ„Ù‰": { "home": 700, "desk": 400 },
      "Ø§Ù„Ù†Ø¹Ø§Ù…Ø©": { "home": 800, "desk": 500 },
      "Ø¹ÙŠÙ† ØªÙ…ÙˆØ´Ù†Øª": { "home": 800, "desk": 400 },
      "ØºØ±Ø¯Ø§ÙŠØ©": { "home": 900, "desk": 500 },
      "ØºÙ„ÙŠØ²Ø§Ù†": { "home": 700, "desk": 400 },
      "ØªÙŠÙ…ÙŠÙ…ÙˆÙ†": { "home": 1100, "desk": 600 },
      "Ø£ÙˆÙ„Ø§Ø¯ Ø¬Ù„Ø§Ù„": { "home": 900, "desk": 500 },
      "Ø¥Ù† ØµØ§Ù„Ø­": { "home": 1300, "desk": 600 },
      "Ø¬Ø§Ù†Øª": { "home": 1100, "desk": 500 }
    };

    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    const wilayaSelect = document.getElementById("wilaya");
    Object.keys(deliveryPrices).forEach(w => {
      const opt = document.createElement("option"); 
      opt.value = w; 
      opt.textContent = w; 
      wilayaSelect.appendChild(opt);
    });

    // Ø¹Ù†Ø§ØµØ± DOM Ù…Ù‡Ù…Ø©
    const addToCartBtn = document.getElementById("addToCartBtn");
    const piecesContainer = document.getElementById("piecesContainer");
    const personalSection = document.getElementById("personalSection");
    const orderControls = document.getElementById("orderControls");
    const cancelOrderBtn = document.getElementById("cancelOrder");
    const confirmOrderBtn = document.getElementById("confirmOrder");
    const finalSubmitDiv = document.getElementById("finalSubmit");
    const submitBtn = document.getElementById("submitBtn");
    const priceDetailsEl = document.getElementById("priceDetails");
    const loadingEl = document.getElementById("loading");

    let pieceCount = 0;
    let currentTotal = 0;

    // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„/Ø§Ù„Ù…Ù‚Ø§Ø³
    function getSize(height){
      if(height >= 6 && height <= 7) return "S1";
      if(height >= 8 && height <= 9) return "S2";
      if(height >= 10 && height <= 11) return "S3";
      if(height >= 12 && height <= 13) return "S4";
      return "ØºÙŠØ± Ù…ØªÙˆÙØ±";
    }

    // Ø¥Ø¶Ø§ÙØ© Ù‚Ø·Ø¹Ø©
    function addPiece(){
      pieceCount++;
      const div = document.createElement("div");
      div.className = "piece";
      const heightOptions = Array.from({length: 10}, (_, i) => `<option value="${5+i}">${5+i} Ø³Ù†ÙˆØ§Øª</option>`).join('');
      
      div.innerHTML = `
        <label>ğŸ§© Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„:</label>
        <select name="modal${pieceCount}" onchange="showModalImage(this, ${pieceCount}); updatePrice();" required>
          <option value="">-- Ø§Ø®ØªØ± --</option>
          <option value="1">Ù…ÙˆØ¯Ø§Ù„ 1</option>
          <option value="2">Ù…ÙˆØ¯Ø§Ù„ 2</option>
          <option value="3">Ù…ÙˆØ¯Ø§Ù„ 3</option>
          <option value="4">Ù…ÙˆØ¯Ø§Ù„ 4</option>
          <option value="5">Ù…ÙˆØ¯Ø§Ù„ 5</option>
          <option value="6">Ù…ÙˆØ¯Ø§Ù„ 6</option>
          <option value="7">Ù…ÙˆØ¯Ø§Ù„ 7</option>
          <option value="8">Ù…ÙˆØ¯Ø§Ù„ 8</option>
          <option value="9">Ù…ÙˆØ¯Ø§Ù„ 9</option>
          <option value="10">Ù…ÙˆØ¯Ø§Ù„ 10</option>
          <option value="11">Ù…ÙˆØ¯Ø§Ù„ 11</option>
          <option value="12">Ù…ÙˆØ¯Ø§Ù„ 12</option>
          <option value="13">Ù…ÙˆØ¯Ø§Ù„ 13</option>
          <option value="14">Ù…ÙˆØ¯Ø§Ù„ 14</option>
          <option value="15">Ù…ÙˆØ¯Ø§Ù„ 15</option>
          <option value="16">Ù…ÙˆØ¯Ø§Ù„ 16</option>
          
          
        </select>
        <div id="modalImage${pieceCount}" style="margin-top:10px; text-align:center;"></div>

        <label>ğŸ”¢ Ø§Ù„ÙƒÙ…ÙŠØ©:</label>
        <select name="quantity${pieceCount}" onchange="updatePrice()" required>
          ${Array.from({length: 10}, (_, i) => `<option value="${i+1}">${i+1}</option>`).join('')}
        </select>

        <label>ğŸ¨ Ø§Ù„Ù„ÙˆÙ†:</label>
        <select name="color${pieceCount}" required>
          <option value="Ø£Ø¨ÙŠØ¶">Ø£Ø¨ÙŠØ¶</option>
          <option value="Ø£Ø³ÙˆØ¯">Ø£Ø³ÙˆØ¯</option>
          <option value="Ø±Ù…Ø§Ø¯ÙŠ">Ø±Ù…Ø§Ø¯ÙŠ</option>
          <option value="Ø£Ø²Ø±Ù‚">Ø£Ø²Ø±Ù‚</option>
          <option value="Ø£Ø­Ù…Ø±">Ø£Ø­Ù…Ø±</option>
          <option value="Ø£Ø®Ø¶Ø±">Ø£Ø®Ø¶Ø±</option>
        </select>

        <label>ğŸ“ Ø¹Ù…Ø± Ø§Ù„Ø·ÙÙ„:</label>
        <select name="age${pieceCount}" onchange="updateSize(this, ${pieceCount})" required>${heightOptions}</select>

        <label>ğŸ“ Ø§Ù„Ù…Ù‚Ø§Ø³:</label>
        <input type="text" name="size${pieceCount}" id="size${pieceCount}" readonly>

        <button type="button" onclick="removePiece(this)" style="margin-top:10px; background:#ef4444; color:#fff; border:none; border-radius:8px; padding:8px 10px;">ğŸ—‘ï¸ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨</button>
      `;
      
      piecesContainer.appendChild(div);
      personalSection.classList.remove("hidden");
      orderControls.classList.remove("hidden");
      finalSubmitDiv.classList.remove("hidden");
      submitBtn.disabled = true;
      updatePrice();
    }

    // Ø¥Ø²Ø§Ù„Ø© Ù‚Ø·Ø¹Ø©
    function removePiece(button){
      button.closest(".piece").remove();
      updatePrice();
      
      if(document.querySelectorAll(".piece").length === 0){
        personalSection.classList.add("hidden");
        orderControls.classList.add("hidden");
        finalSubmitDiv.classList.add("hidden");
      }
    }

    // Ø¹Ø±Ø¶ ØµÙˆØ±Ø©
    function showModalImage(select, id){
      const imgDiv = document.getElementById(`modalImage${id}`);
      const val = select.value;
      if(!val){ 
        imgDiv.innerHTML = ""; 
        return; 
      }
      
      const modalImages = {
        "1": "images/modal1.jpg",
        "2": "images/modal2.jpg",
        "3": "images/modal3.jpg",
        "4": "images/modal4.jpg",
        "5": "images/modal5.jpg",
         "6": "images/modal6.jpg.webp",
         "7": "images/modal7.jpg.webp",
         "8": "images/modal8.jpg.webp",
         "9": "images/modal9.jpg.webp",
         "10": "images/modal10.jpg.webp",
          "11": "images/modal11.jpg.webp",
          "12": "images/modal12.jpg.webp",
          "13": "images/modal13.jpg.webp",
          "14": "images/modal14.jpg.webp",
          "15": "images/modal15.jpg.webp",
          "16": "images/modal16.jpg.webp"
      };
      
      imgDiv.innerHTML = `<img src="${modalImages[val]}" alt="Ù…ÙˆØ¯Ø§Ù„ ${val}" style="max-width:220px; border-radius:8px;">`;
    }

    function updateSize(select, id){
      const height = parseInt(select.value);
      if(height) document.getElementById(`size${id}`).value = getSize(height);
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø±
    function updatePrice() {
      let totalPieces = 0;
      let subtotal = 0;

      for (let i = 1; i <= pieceCount; i++) {
        const quantityEl = document.querySelector(`[name="quantity${i}"]`);
        if (quantityEl) {
          const qty = parseInt(quantityEl.value) || 0;
          totalPieces += qty;
        }
      }

      let unitPrice = (totalPieces >= 2) ? 3000 : 3300;
      subtotal = totalPieces * unitPrice;

      const wilaya = document.getElementById("wilaya").value;
      const deliveryType = document.getElementById("deliveryType").value;
      const deliveryCost = deliveryPrices[wilaya] ? deliveryPrices[wilaya][deliveryType] : 0;

      currentTotal = subtotal + deliveryCost;

      priceDetailsEl.innerHTML = `
        ğŸ’° Ø³Ø¹Ø± Ø§Ù„Ù‚Ø·Ø¹Ø©: ${unitPrice} Ø¯Ø¬ <br>
        ğŸ”¢ Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø·Ø¹: ${totalPieces} <br>
        ğŸ’¸ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${subtotal} Ø¯Ø¬ <br>
        ğŸšš Ø§Ù„ØªÙˆØµÙŠÙ„: ${deliveryCost} Ø¯Ø¬ <br>
        âœ… Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ: ${currentTotal} Ø¯Ø¬
      `;
      
      return currentTotal;
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¹Ø± Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ© Ø£Ùˆ Ù†ÙˆØ¹ Ø§Ù„ØªÙˆØµÙŠÙ„
    wilayaSelect.addEventListener("change", updatePrice);
    document.getElementById("deliveryType").addEventListener("change", updatePrice);

    // Ø²Ø± "Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©"
    addToCartBtn.addEventListener("click", () => {
      addPiece();
      setTimeout(() => window.scrollTo({ 
        top: document.getElementById('orderForm').offsetTop + 200, 
        behavior: 'smooth' 
      }), 200);
    });

    // Ø²Ø± Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨ÙŠØ©
    cancelOrderBtn.addEventListener("click", () => {
      piecesContainer.innerHTML = "";
      pieceCount = 0;
      currentTotal = 0;
      priceDetailsEl.innerHTML = `ğŸ’° Ø§Ù„Ø³Ø¹Ø± : 0 Ø¯Ø¬<br>ğŸ’¸ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ: 0 Ø¯Ø¬`;
      personalSection.classList.add("hidden");
      orderControls.classList.add("hidden");
      finalSubmitDiv.classList.add("hidden");
      submitBtn.disabled = true;
      
      document.getElementById('name').value = "";
      document.getElementById('phone').value = "";
      document.getElementById('daire').value = "";
      document.getElementById('address').value = "";
      
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Ø²Ø± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ÙŠØ©
    confirmOrderBtn.addEventListener("click", () => {
      submitBtn.disabled = false;
      submitBtn.style.transform = "scale(1.02)";
      submitBtn.style.boxShadow = "0 10px 24px rgba(0,0,0,0.2)";
      confirmOrderBtn.textContent = "âœ… ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯";
      confirmOrderBtn.disabled = true;
      
      setTimeout(() => window.scrollTo({ 
        top: submitBtn.getBoundingClientRect().top + window.scrollY - 80, 
        behavior: 'smooth' 
      }), 200);
    });

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
    document.getElementById("orderForm").addEventListener("submit", function(e){
      e.preventDefault();
      
      if(submitBtn.disabled){
        alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ÙŠØ©' Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.");
        return;
      }
      
      const form = this;
      const formData = new FormData(form);
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      formData.append('total', currentTotal);
      
      loadingEl.classList.remove('hidden');

      fetch(SCRIPT_URL, { method: 'POST', body: formData })
        .then(res => {
          if (!res.ok) {
            throw new Error('Network response was not ok');
          }
          return res.text();
        })
        .then(data => {
          loadingEl.classList.add('hidden');
          
          // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­
          document.getElementById('totalPrice').textContent = `ğŸ’¸ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${currentTotal} Ø¯Ø¬`;
          document.getElementById('successModal').classList.add('show');
          
          // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
          form.reset();
          piecesContainer.innerHTML = "";
          pieceCount = 0;
          currentTotal = 0;
          personalSection.classList.add("hidden");
          orderControls.classList.add("hidden");
          finalSubmitDiv.classList.add("hidden");
          submitBtn.disabled = true;
          priceDetailsEl.innerHTML = `ğŸ’° Ø§Ù„Ø³Ø¹Ø± : 0 Ø¯Ø¬<br>ğŸ’¸ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙƒÙ„ÙŠ: 0 Ø¯Ø¬`;
          
          confirmOrderBtn.textContent = "âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ÙŠØ©";
          confirmOrderBtn.disabled = false;
        })
        
    });

    function closeModal(){ 
      document.getElementById('successModal').classList.remove('show');
    }

    // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
    window.addPiece = addPiece;
    window.removePiece = removePiece;
    window.showModalImage = showModalImage;
    window.updateSize = updateSize;
    window.updatePrice = updatePrice;
    window.closeModal = closeModal;
  </script>
</body>
</html>
